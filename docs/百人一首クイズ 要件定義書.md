# 百人一首クイズ 要件定義書

## 1. 概要
- 本ドキュメントは、百人一首の知識向上を目的としたクイズアプリケーションの機能および仕様を定義するものです。利用者は上の句から下の句を当てる4択クイズを通じて、百人一首への理解を深めることができます。

## 2. データソース
- ファイル名: hyakunin_isshu.json
- 利用データ項目:
    - id: 歌番号
    - upper: 問題文（上の句）
    - lower: 正解の選択肢（下の句）
    - description: 解説文

## 3. 機能要件

### 3.1. クイズ出題機能
#### 問題の生成:
- 100首の歌データ（hyakunin_isshu.json）を読み込みます。
#### 出題順序:
-利用者は以下のいずれかの出題順を選択できます。
    - ID順: idが1番から100番まで順番に出題します。
    -ランダム: 100首の中からランダムな順序で出題します。
#### 問題表示:
- 画面に問題となる歌の「上の句」(upper)を表示します。

### 3.2. 回答機能
#### 回答形式:
- 4択の選択肢形式とします。
#### 選択肢の構成:
- 正解: 1つ。問題の「上の句」に対応する「下の句」(lower)を表示します。
- 不正解: 3つ。問題となっている歌以外の99首から、ランダムに選んだ「下の句」(lower)を重複なく表示します。
- 表示順: 4つの選択肢（正解1つ、不正解3つ）は、毎回ランダムな順序で表示します。

### 3.3. 正誤判定・解説表示機能
#### トリガー:
- 利用者が選択肢を選び、「回答」ボタンをクリックした際に実行します。

#### 正誤判定:
- 利用者が選択した下の句が、問題の上の句と対になっているか判定します。

#### フィードバック表示:
##### 正解の場合:
- 利用者が選択した選択肢の背景を青色で表示します。
- 「正解！」などのメッセージを表示します。

#### 不正解の場合:
- 利用者が選択した選択肢の背景を赤色で表示します。
- 「不正解…」などのメッセージを表示します。
- （推奨）正解の選択肢がどれであったか、別途ハイライト（例：緑色の背景）で表示します。

#### 解説表示:
- 正誤判定と同時に、その歌の解説(description)を表示します。

### 3.4. 画面遷移・進行機能
#### 次の問題へ:
- 「次の問題」ボタンをクリックすると、現在の問題・解説がクリアされ、次の問題が表示されます。

#### クイズの終了:
- 全100問の出題が終了した場合、「クイズ終了です。お疲れ様でした！」などのメッセージを表示します。

## 4. 画面設計（UI/UX要件）

### 4.1. 画面構成要素
#### 問題番号表示エリア: 
- 例：「第1問」
#### 問題文表示エリア: 
- 上の句を表示するテキストフィールド。
#### 選択肢エリア: 
- 4つの下の句をそれぞれクリック可能なボタンとして配置。
#### 操作ボタンエリア:
- 「回答」ボタン
- 「次の問題」ボタン
#### 結果・解説表示エリア:
- 正誤メッセージ（例：「正解！」）を表示する領域。
- 歌の解説を表示する領域。

### 4.2. 操作フローと画面状態
#### 初期表示:
- 問題文（上の句）と4つの選択肢（下の句）が表示される。
- 「回答」ボタンは有効。
- 「次の問題」ボタンは無効。
- 結果・解説エリアは非表示。

#### 選択肢を選択後:
- 利用者がいずれかの選択肢をクリックすると、選択状態がわかるように表示を変化させる（任意）。

#### 「回答」ボタンクリック後:
- 選択肢のクリック（再選択）を不可にする。
- 正誤判定に基づき、選択肢の背景色を変更する。
- 結果・解説エリアを表示する。
- 「回答」ボタンを無効にする。
- 「次の問題」ボタンを有効にする。

#### 「次の問題」ボタンクリック後:
- 画面全体を初期表示の状態に戻し、次の問題データを読み込んで表示する。

## 5. 処理フロー概略図

```
graph TD
    A[クイズ開始] --> B{出題順を選択};
    B --> C[問題リスト作成<br>(ID順 or ランダム)];
    C --> D[次の問題を取得];
    D --> E[問題(上の句)を表示];
    E --> F[選択肢(下の句)を生成・表示<br>- 正解x1, 不正解x3<br>- ランダム配置];
    F --> G{選択肢を選択};
    G --> H[「回答」ボタンクリック];
    H --> I{正誤判定};
    I -- 正解 --> J[選択肢を青色表示];
    I -- 不正解 --> K[選択肢を赤色表示];
    J & K --> L[解説を表示];
    L --> M[「次の問題」ボタンクリック];
    M --> N{全問終了？};
    N -- No --> D;
    N -- Yes --> O[終了メッセージ表示];
    O --> P[END];
```